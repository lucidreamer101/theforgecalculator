<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>The Forge Calculator Pro</title>

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚öîÔ∏è</text></svg>">

<style>
@import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Roboto:wght@400;500;700&display=swap');

:root {
    --bg:#0d0d0d; --card:#1a1a1a; --accent:#ff4d00;
    --gold:#ffd700; --text:#fff; --text-dim:#999;
    --border:#333; --success:#00ff88; --danger:#ff3366;
}

* { box-sizing:border-box; margin:0; padding:0; }
body {
    font-family:'Roboto',sans-serif;
    background:var(--bg);
    color:var(--text);
    padding:15px;
    padding-bottom:60px;
}

h1 {
    font-family:'Cinzel',serif;
    text-align:center;
    color:var(--gold);
    margin:20px 0;
    letter-spacing:2px;
}

.container { max-width:900px; margin:auto; }

.panel {
    background:var(--card);
    border-radius:16px;
    padding:20px;
    margin-bottom:15px;
    border:1px solid var(--border);
}

.mode-switch { display:flex; gap:12px; margin-bottom:20px; }
.mode-btn {
    flex:1; padding:14px;
    background:var(--card);
    border:2px solid var(--border);
    border-radius:12px;
    font-weight:700;
    color:var(--text-dim);
    cursor:pointer;
}
.mode-btn.active {
    background:var(--accent);
    color:#fff;
    border-color:var(--accent);
}

.stats-grid { display:grid; grid-template-columns:1fr 1fr; gap:12px; }
.stat-box {
    background:#252525;
    padding:15px;
    border-radius:12px;
    border:1px solid #444;
    text-align:center;
}
.stat-val { font-size:1.8rem; font-weight:700; color:var(--accent); }
.stat-lbl { font-size:.7rem; text-transform:uppercase; color:var(--text-dim); }

.selected-list {
    display:flex;
    gap:10px;
    overflow-x:auto;
    padding:10px 0;
    min-height:90px;
}

.sel-item {
    min-width:80px;
    background:#2a2a2a;
    padding:10px;
    border-radius:12px;
    border:2px solid var(--accent);
    text-align:center;
    position:relative;
    cursor:pointer;
}

.remove-tag {
    position:absolute;
    top:-5px; right:-5px;
    width:20px; height:20px;
    border-radius:50%;
    background:var(--danger);
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:12px;
}

.search {
    width:100%;
    padding:15px;
    margin-bottom:15px;
    background:#1a1a1a;
    border:2px solid #333;
    color:#fff;
    border-radius:12px;
}

.ore-grid {
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(90px,1fr));
    gap:10px;
}

.ore-card {
    background:#1a1a1a;
    border:2px solid #333;
    border-radius:12px;
    padding:15px 5px;
    text-align:center;
    cursor:pointer;
}
.ore-card:hover { border-color:var(--accent); }

.prob-row {
    display:flex;
    justify-content:space-between;
    padding:10px 0;
    border-bottom:1px solid #222;
}
.prob-chance { color:var(--gold); font-weight:700; }
</style>
</head>

<body>
<div class="container">

<h1>‚öîÔ∏è THE FORGE CALCULATOR ‚öîÔ∏è</h1>

<div class="mode-switch">
    <button id="btn-weapon" class="mode-btn active">‚öîÔ∏è WEAPON</button>
    <button id="btn-armor" class="mode-btn">üõ°Ô∏è ARMOR</button>
</div>

<div class="panel">
    <div class="stats-grid">
        <div class="stat-box"><div id="avgMult" class="stat-val">0.00x</div><div class="stat-lbl">Avg Mult</div></div>
        <div class="stat-box"><div id="oreCount" class="stat-val">0</div><div class="stat-lbl">Ores</div></div>
    </div>
    <div id="purityMsg" style="margin-top:15px"></div>
</div>

<div class="panel">
    <div style="font-size:.7rem;color:var(--text-dim)">POT CONTENT</div>
    <div id="selected" class="selected-list"></div>
</div>

<div class="panel">
    <div id="probs"></div>
</div>

<input id="search" class="search" placeholder="Search ores...">
<div id="grid" class="ore-grid"></div>

</div>

<script>
// ---------------- DATA ----------------
const ORES = [
 {name:'Stone',mult:0.2,icon:'ü™®'}, {name:'Sandstone',mult:0.25,icon:'‚è≥'},
 {name:'Copper',mult:0.3,icon:'üü†'}, {name:'Iron',mult:0.35,icon:'‚öôÔ∏è'},
 {name:'Tin',mult:0.425,icon:'ü•´'}, {name:'Silver',mult:0.5,icon:'‚ö™'},
 {name:'Gold',mult:0.65,icon:'üü°'}, {name:'Cardboardite',mult:0.7,icon:'üì¶'},
 {name:'Cobalt',mult:1.0,icon:'üîµ'}, {name:'Titanium',mult:1.15,icon:'üõ°Ô∏è'},
 {name:'Diamond',mult:2.0,icon:'üíé'}, {name:'Obsidian',mult:2.35,icon:'‚¨õ'},
 {name:'Cuprite',mult:2.43,icon:'üß±'}, {name:'Ruby',mult:2.95,icon:'‚ù§Ô∏è'},
 {name:'Rivalite',mult:3.33,icon:'‚ö°'}, {name:'Mythril',mult:3.5,icon:'‚ú®'},
 {name:'Fireite',mult:4.5,icon:'üî•'}, {name:'Magmaite',mult:5.0,icon:'üåã'},
 {name:'Demonite',mult:5.5,icon:'üòà'}, {name:'Darkryte',mult:6.3,icon:'üåë'},
 {name:'Rainbow Crystal',mult:5.25,icon:'üåà'}, {name:'Arcane Crystal',mult:7.5,icon:'üîÆ'}
];

const ORE_MAP = Object.fromEntries(ORES.map(o => [o.name,o]));

const WEAPON_PROBS = {
 0:{Scrap:100},
 3:{Dagger:70,Gauntlet:30},
 8:{Katana:50,Longsword:50},
 15:{Greatsword:60,'Colossal Blade':40},
 25:{Godslayer:20,'Colossal Blade':80}
};

const ARMOR_PROBS = {
 0:{Cloth:100},
 5:{'Light Set':100},
 12:{'Medium Set':70},
 22:{'Heavy Set':80},
 40:{'Abyssal Armor':30}
};

// ---------------- STATE ----------------
let pot = {};
let mode = 'weapon';

// ---------------- LOGIC ----------------
function setMode(m){
 mode=m;
 document.getElementById('btn-weapon').classList.toggle('active',m==='weapon');
 document.getElementById('btn-armor').classList.toggle('active',m==='armor');
 update();
}

function addOre(name){
 if(!pot[name] && Object.keys(pot).length>=6) return;
 pot[name]=(pot[name]||0)+1;
 update();
}

function removeOre(name){
 if(pot[name]>1) pot[name]--;
 else delete pot[name];
 update();
}

function update(){
 const total=Object.values(pot).reduce((a,b)=>a+b,0);
 let sum=0, max=0;

 for(const n in pot){
   const o=ORE_MAP[n];
   sum+=o.mult*pot[n];
   if(o.mult>max) max=o.mult;
 }

 const avg=total?+(sum/total).toFixed(3):0;
 document.getElementById('avgMult').textContent=avg.toFixed(2)+'x';
 document.getElementById('oreCount').textContent=total;

 const purity=document.getElementById('purityMsg');
 if(!total){ purity.innerHTML=''; }
 else{
   const ratio=Math.min(1,avg/max);
   purity.innerHTML=
     ratio>=0.85?`<div style="color:var(--success)">üíé PURITY ${(ratio*100).toFixed(0)}%</div>`:
     ratio>=0.5?`<div style="color:var(--gold)">‚ö†Ô∏è PURITY ${(ratio*100).toFixed(0)}%</div>`:
     `<div style="color:var(--danger)">‚ùå POOR PURITY</div>`;
 }

 renderSelected();
 renderProbs(total);
}

function renderSelected(){
 const el=document.getElementById('selected');
 el.innerHTML='';
 for(const n in pot){
  const o=ORE_MAP[n];
  const d=document.createElement('div');
  d.className='sel-item';
  d.innerHTML=`<div>${o.icon}</div><div>√ó${pot[n]}</div><div class="remove-tag">√ó</div>`;
  d.onclick=()=>removeOre(n);
  el.appendChild(d);
 }
}

function renderProbs(total){
 const tbl=mode==='weapon'?WEAPON_PROBS:ARMOR_PROBS;
 const keys=Object.keys(tbl).map(Number).sort((a,b)=>b-a);
 const k=keys.find(v=>total>=v) ?? keys[keys.length-1];
 const items=tbl[k];
 const c=document.getElementById('probs');
 c.innerHTML=`<div style="font-size:.7rem;color:var(--text-dim)">SUCCESS (${total} ores)</div>`;
 for(const i in items){
   c.innerHTML+=`<div class="prob-row"><span>${i}</span><span class="prob-chance">${items[i]}%</span></div>`;
 }
}

function renderGrid(){
 const q=document.getElementById('search').value.toLowerCase();
 const g=document.getElementById('grid');
 g.innerHTML='';
 ORES.filter(o=>o.name.toLowerCase().includes(q)).forEach(o=>{
  const d=document.createElement('div');
  d.className='ore-card';
  d.onclick=()=>addOre(o.name);
  d.innerHTML=`<div style="font-size:1.5rem">${o.icon}</div><div>${o.name}</div><div style="color:var(--gold)">${o.mult}x</div>`;
  g.appendChild(d);
 });
}

// ---------------- INIT ----------------
document.getElementById('btn-weapon').onclick=()=>setMode('weapon');
document.getElementById('btn-armor').onclick=()=>setMode('armor');
document.getElementById('search').oninput=renderGrid;

renderGrid();
</script>
</body>
</html>
